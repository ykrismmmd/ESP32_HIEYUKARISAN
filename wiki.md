# ここはESP32_冷えゆかりさんのwikiです。

# 1.概要・購入方法
## (1)概要
周囲の明るさの変化を感知し、ランダムに音声を再生します。  
基板類はペーパークラフトに収納します。


# 2.作品紹介
## (1)冷えゆかり

# 3.組み立て説明
## (1)ペーパークラフト
頭部のサイズは、ペーパークラフト　Graphig（グラフィグ）　NC Empire / NC帝國(https://ncempire.net/1)をA3印刷し、組み立てたたサイズに最適化してあります。  
Graphig（グラフィグ）については、無償での配布は認められていますが、有償での配布、販売は認められていないため、本作品と合わせて販売、配布することはできません。  
皆さまお好きなGraphig（グラフィグ）をご用意・印刷・組立し、ご利用ください。  


### a.印刷設定
ゆかりずむが個人的におすすめする印刷設定は次の通りです

> 印刷サイズ: A3  
> 余白設定:なし、または狭い
> できるだけ原寸に近い大きさにします。縮小印刷されると、頭部が小さくなってしまい、冷えゆかりユニットを収納できなくなります。

> 紙の種類：光沢紙または耐水紙  
> 普通紙だと、頭部の重量を支えきれない場合があります。また、結露によりもろくなる可能性があります。

> 印刷方式：カラーレーザー  
> インクジェット方式でも組立可能ですが、結露により滲み、色落ちが発生するおそれがあります。

> 紙の加工：ラミネートまたは耐水  
> 可能な場合のみ。強度が増し、結露に強くなります。

### b.組立て
ペーパークラフトの上手な組み立て方は、書籍やインターネット上にたくさん掲載されていますので、そちらを参照したほうがよいです。
> 切り出し  
> ①はさみやカッターで大まかに切り出します  
> ②細部をアートナイフで切り出します。

> 折り目加工  
> 折り線にあわせて定規を当て、尖ったものでなぞってから折ります。  
> 折り目がまっすぐはっきりして、格好良くなります。

## (2)冷えゆかりユニット  

# 4.設定説明

## (1)電源の投入
9V乾電池を接続すると、電源が投入されます。  

## 火花が散る、煙が出る、電線が外れる等の異常が見られた場合は、すぐに乾電池を取り外してください。


## (2)初回起動時
正常に起動すると、次の通り音声アナウンスが行われます。
> スピーカーから「パチッ」とポップ音がする  
>「DFPlayer miniの起動に成功しました」  
>「フラッシュメモリのマウントに成功しました」  
>「WiFi接続試行中です」  
>「WiFi接続がタイムアウトしました。アクセスポイントモードに切り替えます。」


## (3)WiFi設定
環境に応じて、WiFI設定を行います。

### a.既設APに接続する場合
スマートフォン、タブレットまたはPCの無線LAN接続設定から、
> SSID「HIEYUKARI_SETTEI_ESP32」
を探します。  
<img src="https://user-images.githubusercontent.com/54070669/159830873-2af0f4d7-08c8-41b4-bd24-5ff3f889861a.jpg" width="320px">


>当該ネットワークに接続すると、WiFi設定画面が表示されます。
<img src="https://user-images.githubusercontent.com/54070669/159852802-4548b874-5500-4316-a0dc-4f436e31beb1.jpg" width="320px">


>「WiFi設定開始」ボタンをタップして、WiFiアクセスポイント設定画面を開きます。  
<img src="https://user-images.githubusercontent.com/54070669/159853274-29012b26-759a-4872-b9ac-5252c9570ff6.jpg" width="320px">


>「SSID」のドロップダウンリストをタップして、接続したいアクセスポイントのSSIDを選択します。  
<img src="https://user-images.githubusercontent.com/54070669/159861756-e3b099ee-4bc9-46e7-a30e-c9c83dc6b022.jpg" width="320px">


>「Password」にアクセスポイントのパスワードを入力し、「設定」ボタンをタップします。  
<img src="https://user-images.githubusercontent.com/54070669/159862726-8c326c6f-ef3e-457b-b7c8-c785d9bbf4dc.jpg" width="320px">


>「設定を適用して再起動」ボタンをタップします。  
<img src="https://user-images.githubusercontent.com/54070669/159863352-fba07283-5950-4079-a394-c3ce335d95e9.jpg" width="320px">


## b.WiFi接続成功時  
正常に起動し、WiFiに接続成功すると、次の通り音声アナウンスが行われます。
> スピーカーから「パチッ」とポップ音がする  
>「DFPlayer miniの起動に成功しました」  
>「フラッシュメモリのマウントに成功しました」  
>「WiFi接続試行中です」  
>「WiFi接続完了しました」  
>「NTP時刻同期を行いました」  
>「冷えゆかり、起動完了しました」  


## c.テザリングで接続する場合
スマートフォン等のテザリング設定で
> SSID:HIEYUKARI  
> Password:HIEYUKARI  

を設定する。

## d.再起動
9V乾電池を取り外してからもう一度取り付け、再起動します。 

## e.WiFi接続成功時
正常に起動し、WiFiに接続成功すると、次の通り音声アナウンスが行われます。
> スピーカーから「パチッ」とポップ音がする  
>「DFPlayer miniの起動に成功しました」  
>「フラッシュメモリのマウントに成功しました」  
>「WiFi接続試行中です」  
>「WiFi接続完了しました」  
>「NTP時刻同期を行いました」  
>「冷えゆかり、起動完了しました」  

## f.時刻同期状態の確認
何回か動作させると、「だいたい○○時台をお知らせします」と再生されるので、現在の時刻と合っているか確認してください。

## ステータスの確認方法
起動時にアナウンスする言葉と内容は次の通りです。
> 1.スピーカーから「パチッ」とポップ音がする  

電源が入り、スピーカーに通電された音です。

> 2-1.「DFPlayer miniの起動に成功しました」 

mp3再生ユニット「DFPlayer mini」の起動に成功したアナウンスです。  

> 2-2.なにもアナウンスされない

DFPlayer miniの起動に失敗しているため、音声を再生することができない状態です。  
メモリーカードが挿入されているか、接触不良がないか確認して、電池をつけ外しして再起動してください。

> 3-1.「フラッシュメモリのマウントに成功しました」

ESP32内フラッシュメモリのマウントに成功したアナウンスです。
フラッシュメモリには、前回接続時のSSID、パスワードが記録されています。

>　3-2.「フラッシュメモリのマウントに失敗しました」

ESP32内フラッシュメモリのマウントに失敗したアナウンスです。
電池をつけ外しして再起動してください。

> 4.「WiFi接続試行中です」

1回目の起動時は、デフォルトのSSID、パスワードを用いてWiFi接続を試みています。
起動したことがある場合は、前回接続していたSSID、パスワードを用いてWifi接続を試みています。

> 5-1.「WiFi接続完了しました」

WiFi接続に成功したアナウンスです。

> 5-2.「WiFi接続がタイムアウトしました。アクセスポイントモードに切り替えます。」

どのAPにも接続できず、タイムアウトしたアナウンスです。
アクセスポイントモードに切り替わるので、スマートフォン等を用いて設定を行ってください。

> 6.「NTP時刻同期を行いました」  

インターネット経由で時刻同期を行ったアナウンスです。

> 7.「冷えゆかり、起動完了しました」 

冷えゆかりの起動が完了したアナウンスです。

# ヘルプ